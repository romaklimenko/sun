function initializeDates(){var t=(new Date).getFullYear(),e=1===new Date(t,1,29).getMonth(),a=e?366:365;for(dates=[],i=0;a>i;i++)dates.push(moment().startOf("year").add(i,"d"))}function renderInformers(){var t=moment().add(-1,"d")._d,e=t.sunrise(latitude,longitude),a=t.sunset(latitude,longitude),r=moment.duration(a-e).asMinutes(),i=new Date,n=i.sunrise(latitude,longitude),o=i.sunset(latitude,longitude),d=moment.duration(o-n).asMinutes(),s=moment().add(1,"d")._d,u=s.sunrise(latitude,longitude),l=s.sunset(latitude,longitude),p=moment.duration(l-u).asMinutes();$("#yesterday").html("Yesterday was "+Math.abs(Math.round(r-d))+" minutes "+(r>d?" longer &uarr;":"shorter &darr;")),$("#today").html("Today, at "+address+", sunrise at "+moment(n).format("HH:mm")+" and sunset at "+moment(o).format("HH:mm")),$("#tomorrow").html("Tomorrow will be "+Math.abs(Math.round(d-p))+" minutes "+(p>d?" longer &uarr;":"shorter &darr;"))}function renderPaper(){$("#paper").height($(window).height()-$("header").height()-70),$("#paper").html(""),paper=new Raphael("paper",$("#paper").width(),$("#paper").height())}function renderSunriseAndSunset(){function t(t){return t*n}function e(t){return(60*t.getHours()+t.getMinutes())*o}var a=$("#paper").height(),r=$("#paper").width(),n=r/(dates.length-1),o=a/1440,d=a/24,s=[],u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(i=0;24>i;i++)paper.path(["M",0,d*i,"L",r,d*i]).attr({stroke:"#93a1a1"}),paper.text(15,d*i+d/2,i+":00").attr({fill:"#93a1a1"});for(paper.path(["M",0,a-1,"L",r,a-1]).attr({stroke:"#93a1a1"}),i=0;i<dates.length;i++){var l=dates[i]._d;0!==i&&1===l.getDate()?paper.path(["M",t(i),0,"L",t(i),a]).attr({stroke:"#93a1a1"}):15===l.getDate()&&paper.text(t(i),10,u[l.getMonth()]).attr({fill:"#93a1a1"}),s=s.concat(0===i?["M",t(i),e(l.sunrise(latitude,longitude))]:["L",t(i),e(l.sunrise(latitude,longitude))])}for(i=dates.length-1;i>=0;i--)s=s.concat(["L",t(i),e(dates[i]._d.sunset(latitude,longitude))]);s=s.concat(["Z"]),paper.path().attr({fill:"#fdf6e3","fill-opacity":.5,path:s,stroke:"#657b83"});var p=new Date;paper.path(["M",0,e(p),"L",r,e(p)]).attr({stroke:"#cb4b16"});var g=(moment(p).dayOfYear()-1)*n;paper.path(["M",g,0,"L",g,a]).attr({stroke:"#cb4b16"}),paper.circle(g,e(p),5).attr({fill:"#FFFF00",stroke:"#cb4b16"})}function reset(){initializeDates(),renderInformers(),renderPaper(),renderSunriseAndSunset()}function initializeLocation(){function t(t){latitude=t.coords.latitude,longitude=t.coords.longitude,""===address&&(address=latitude+", "+longitude),$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?latlng="+latitude+","+longitude}).done(function(t){address=t.results[0].formatted_address,reset()}),reset()}Modernizr.geolocation?navigator.geolocation.getCurrentPosition(t):alert("Can't get location :(")}var latitude=55.6712673,longitude=12.5608388,dates,paper,i,address="";initializeLocation(),reset(),$(window).resize(function(){reset()}),setInterval(function(){reset()},6e4);