function initializeLocation(){function e(e){latitude=e.coords.latitude,longitude=e.coords.longitude}Modernizr.geolocation&&navigator.geolocation.getCurrentPosition(e)}function initializeDates(){var e=(new Date).getFullYear(),t=1===new Date(e,1,29).getMonth(),r=t?366:365;dates=[];for(var n=0;r>n;n++)dates.push(moment().startOf("year").add(n,"d"))}function renderInformers(){var e=moment().add(-1,"d"),t=e._d.sunrise(latitude,longitude),r=e._d.sunset(latitude,longitude),n=moment.duration(r-t).asMinutes(),a=moment(),i=a._d.sunrise(latitude,longitude),o=a._d.sunset(latitude,longitude),d=moment.duration(o-i).asMinutes(),s=moment().add(1,"d"),u=s._d.sunrise(latitude,longitude),l=s._d.sunset(latitude,longitude),m=moment.duration(l-u).asMinutes();$("#yesterday").html("Yesterday was "+Math.abs(Math.round(n-d))+" minutes "+(n>d?" longer &uarr;":"shorter &darr;")),$("#today").html(moment(i).format("HH:mm")+"&uarr; • Today • "+moment(o).format("HH:mm")+"&darr;"),$("#tomorrow").html("Tomorrow will be "+Math.abs(Math.round(d-m))+" minutes "+(m>d?" longer &uarr;":"shorter &darr;"))}function renderPaper(){$("#paper").height($(window).height()-$("header").height()-70),$("#paper").html(""),paper=new Raphael("paper",$("#paper").width(),$("#paper").height())}function renderSunriseAndSunset(){for(var e=$("#paper").height(),t=$("#paper").width(),r=t/dates.length,n=e/1440,a=0;a<dates.length;a++){var i=dates[a]._d.sunrise(latitude,longitude);paper.circle(a*r,(60*i.getHours()+i.getMinutes())*n,1).attr({fill:"#000000",stroke:"#000000"});var o=dates[a]._d.sunset(latitude,longitude);paper.circle(a*r,(60*o.getHours()+o.getMinutes())*n,1).attr({fill:"#000000",stroke:"#000000"})}var d=new Date;paper.circle((moment(d).dayOfYear()-1)*r,(60*d.getHours()+d.getMinutes())*n,5).attr({fill:"#FF0000",stroke:"#FF0000"})}function reset(){initializeLocation(),initializeDates(),renderInformers(),renderPaper(),renderSunriseAndSunset()}var latitude=55.6712673,longitude=12.5608388,dates,paper;reset(),$(window).resize(function(){reset()}),setInterval(function(){reset()},6e4);